"use strict";(()=>{var e={};e.id=2477,e.ids=[2477],e.modules={53524:e=>{e.exports=require("@prisma/client")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},42724:(e,t,n)=>{n.r(t),n.d(t,{headerHooks:()=>h,originalPathname:()=>v,patchFetch:()=>y,requestAsyncStorage:()=>p,routeModule:()=>l,serverHooks:()=>g,staticGenerationAsyncStorage:()=>m,staticGenerationBailout:()=>w});var r={};n.r(r),n.d(r,{GET:()=>c,POST:()=>u});var i=n(95419),o=n(69108),a=n(99678),s=n(78070),d=n(3214);async function c(){try{let e=await d._.sectionContent.findMany({where:{sectionType:"trending"},orderBy:{orderIndex:"asc"}}),t=e.map(e=>e.contentId),n=await d._.titles.findMany({where:{id:{in:t}},include:{categories:{select:{name:!0}}}}),r=new Map(n.map(e=>[e.id,e])),i=e.map(e=>{let t=r.get(e.contentId);return{id:e.id,movieId:e.contentId,order:e.orderIndex,movie:t?{id:t.id,name:t.name,mainTitle:t.name,subTitle:t.synopsis,coverUrl:t.coverImageId,category:t.categories}:null,createdAt:e.createdAt}});return s.Z.json(i)}catch(e){return console.error("Failed to fetch trending items:",e),s.Z.json({error:"Failed to fetch items"},{status:500})}}async function u(e){try{let t=await e.json(),n=await d._.sectionContent.create({data:{sectionType:"trending",contentId:t.movieId,orderIndex:t.order}});return s.Z.json(n)}catch(e){return console.error("Failed to create trending item:",e),s.Z.json({error:"Failed to create item"},{status:500})}}let l=new i.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/sections/trending-now/route",pathname:"/api/sections/trending-now",filename:"route",bundlePath:"app/api/sections/trending-now/route"},resolvedPagePath:"/Users/mayingkun/mkwork/cursorproject/H5/DraminiCMS/app/api/sections/trending-now/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:p,staticGenerationAsyncStorage:m,serverHooks:g,headerHooks:h,staticGenerationBailout:w}=l,v="/api/sections/trending-now/route";function y(){return(0,a.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:m})}},3214:(e,t,n)=>{n.d(t,{_:()=>i});var r=n(53524);let i=globalThis.prisma??new r.PrismaClient}};var t=require("../../../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),r=t.X(0,[1638,6206],()=>n(42724));module.exports=r})();